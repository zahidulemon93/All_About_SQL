https://www.topcoder.com/thrive/articles/lead-and-lag-functions-in-sql
